# WAF / API Gateway / Nginx

| 항목         | WAF(Web Application Firewall)                                                                          | API Gateway                                          | Nginx                      |
|------------|--------------------------------------------------------------------------------------------------------|------------------------------------------------------|----------------------------|
| **핵심**     | - 패턴 기반 차단                                                                                             | - 모든 요청은 API Gateway를 거쳐 특정 서비스로 라우팅 <br>- 요쳥 변환과 정책 시행 | - 이벤트 기반 비동기 아키텍처          |
| **보안**     | - 블랙리스트 방식 <br>- 알려진 나쁜것들을 차단                                                                          | - 화이트리스트 방식 <br>- 허용된 것들만 통과                         | - 규칙을 정의하고 효율적으로 실행        |
| **원리**     | - HTTP 요청을 실시간 분석하여 악성 트래픽 탐지 및 차단 <br>- AWS 공격패턴 데이터베이스 활용                                            | - 모든 API요청을 단일 진입점에서 인증, 권한, 변환 처리                   | - 비동기 이벤트 루프 <br>- 모듈기반 아키텍처 |
| **장점**     | - 설정하자마자 즉시 적용 <br>- 수년간 축적된 전문적인 보안 <br>- AWS가 지속적으로 공격패턴 업데이트                                        | - 중앙집중식 관리 <br>- 클라이언트는 백엔드 구조를 알필요 없음 (단일 인터페이스 사용) | - 오픈소스 <br>- 자유로운 커스터마이징   |
| **단점**     | - (False Positive)정상적인 요청을 공격으로 오인하여 차단하는 경우 <br>- 완전히 새로운 형태의 공격에는 대응 지연 <br>- 세밀한 커스터마이징 한계 <br>- 비싼 비용 | - SPOF 가능성 <br>- 모든요청이 API Gateway를 거치는 추가지연         | - 직접 설치 및 복잡한 설정           |
| **비용**     | - 월 5달러 기본요금 <br>- 규칙당 월 1달러 <br>- 요청 100만 건당 0.6 달러                                                   | - 요청당 과금모델                                           | - 오픈소스                     |
| **trade-off** | 편의성 vs 제어권                                                                                             | 중앙집중 관리의 편의성 vs 시스템 복잡성                              | 성능과 제어권 vs 복잡성과 운영 부담      |

# API Gateway
| 항목            | AWS API Gateway                                                            | Spring Cloud Gateway                              | Kong                                                                          |
|---------------|----------------------------------------------------------------------------|---------------------------------------------------|-------------------------------------------------------------------------------|
| **핵심**        | - 서버리스 <br>- 완전 관리형 서비스                                                    | - 스프링철학(Configuration, DI 등)을 API Gateway 영역으로 확장 | - Nginx + Lua + 플러그인 아키텍처                                                     |
| **원리**        | - 각 API 호출은 이벤트로 처리                                                        | - Spring WebFlux 기반 비동기 논블로킹 처리 <br>- 필터체인 패턴 사용  | - Data Plane: 실제 트래픽을 처리하는 Nginx 프로세스 <br>- Control Plane: 설정을 관리하는 Admin API |
| **장점**        | - 완전관리형으로 운영부담 X <br>- 무제한 오토 스케일링 <br>- AWS 생태계와 완벽한 통합                   | - Spring 생태계와 완벽한 통합 <br>- 코드 기반 제어               | - 플러그인 기반의 뛰어난 확장성 <br>- nginx 기반의 성능 <br>- 플랫폼에 독립적                          |
| **단점**        | - AWS 종속 <br>- Cold Start 문제                                               | - JVM 기반의 단점 (높은 메모리, 웜업 등) <br>- Spring 생태계 의존성  | - 가파른 학습곡선 <br>- 운영 부담 (모두 수동) <br>- 여러 플러그인이 체인으로 연결되어있어서 디버깅의 어려움           |
| **비용**        | - 종량제 <br>- REST API: 첫 3억3천3백만건까지 백만건당 3.5 달러 <br>- HTTP API: 첫 3억건까지 백만건당 1 달러 <br>- 데이터전송: 첫 1GB무료 이후 GB당 0.09 달러 | - 오픈소스 <br>- 운영에 필요한 인프라 비용 발생                    | - 오픈소스 <br>- 운영에 필요한 인프라 비용 발생                                                |
| **trade-off** | 편의성 vs 제어권                                                                 | Spring 생태계 통합 vs JVM 오버헤드                         | 확장성 vs 복잡성                                                     |