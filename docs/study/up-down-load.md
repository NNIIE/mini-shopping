# 클라이언트 -> S3
백엔드에서 인증/인가 후 짧은 유효기간의 pre-signed URL 발급하면(임시 업로드 권한) 프론트엔드가 S3에 직접 업로드
- 장점
  - 백엔드 부하 감소
  - 빠른 업로드
- 단점
  - 이미지 검증/처리에 제한적
  - 보안 통제가 상대적으로 약함

# 클라이언트 -> 백엔드 -> S3
모든 업로드가 백엔드를 거쳐 S3로 전송되는 방식
- 장점
  - 보안 제어 용이
  - 파일 검증 가능(타입, 크기, 내용 검사 등)
- 단점
  - 백엔드 부하 증가
  - 프론트 -> 백엔드 -> S3 경로로 인한 업로드 속도 저하

<br>

## 업로드
### Flow - 서울
1. 클라이언트가 백엔드로 pre-signed URL 발급 요청
2. 백엔드가 S3 pre-signed URL 발급
3. 클라이언트가 pre-signed URL을 통해 S3에 이미지 업로드
4. 원본 S3 버킷에 이미지 저장
5. S3 이벤트 발생
6. Lambda 함수 실행 -> 원본 이미지로 썸네일 이미지 생성
7. 썸네일 이미지용 S3 버킷에 저장

### 최적화
표준 크기들의 썸네일들을 미리 생성해두고 특별한 크기가 필요할 때 CloudFront 를 통해 실시간 리사이징을 사용하는 방식 채택
- 썸네일 생성
  - Sharp / Canvas / Jimp 등을 사용하여 이미지 리사이징
- 실시간 리사이징
  - 파라미터를 받아 CloudFront 를 통해 실시간 이미지 최적화

<br>

## 다운로드
### Download Flow - 미국
1. CloudFront 가 썸네일 이미지 요청을 받음
2. DNS 를 통해 가장 가까운 엣지 로케이션으로 연결
3. 서울 썸네일 이미지 버킷에서 이미지 다운로드 및 캐시에 저장
4. 추후 같은 요청이 들어오면 캐시된 이미지 제공

<br>

# 프론트엔드 성능 문제
- 메모리 부족: 브라우저가 대용량 이미지를 메모리에 로드하다가 탭이 크래시될 수 있음
- 렌더링 차단: 이미지 로딩 중 UI가 멈추거나 반응하지 않을 수 있음
- 초기 로딩 지연: 첫 화면 표시까지 시간이 오래 걸림
